#pragma checksum "C:\Users\ponch\projects\LibreriaAlvarez\LibreriaAlvarez.WebApp\Pages\CargarLista.cshtml" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "98a48c22d5d29cc9d295ab59ce8c5ed5e9b8c427"
// <auto-generated/>
#pragma warning disable 1591
namespace LibreriaAlvarez.WebApp.Pages
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Blazor;
    using Microsoft.AspNetCore.Blazor.Components;
    using System.Net.Http;
    using Microsoft.AspNetCore.Blazor.Layouts;
    using Microsoft.AspNetCore.Blazor.Routing;
    using Microsoft.JSInterop;
    using LibreriaAlvarez.WebApp.Shared;
    using LibreriaAlvarez.WebApp;
    using OfficeOpenXml;
    using FileLib;
    using System.Drawing;
    using LibreriaAlvarez.WebApp.Services;
    [Microsoft.AspNetCore.Blazor.Layouts.LayoutAttribute(typeof(MainLayout))]

    [Microsoft.AspNetCore.Blazor.Components.RouteAttribute("/load-prices")]
    public class CargarLista : Microsoft.AspNetCore.Blazor.Components.BlazorComponent
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(Microsoft.AspNetCore.Blazor.RenderTree.RenderTreeBuilder builder)
        {
            base.BuildRenderTree(builder);
            builder.AddMarkupContent(0, "<h1>Carga Listas de Precios</h1>\n");
            builder.OpenElement(1, "div");
            builder.AddAttribute(2, "class", "container");
            builder.AddContent(3, "\n    ");
            builder.OpenElement(4, "div");
            builder.AddAttribute(5, "class", "row");
            builder.AddContent(6, "\n        ");
            builder.OpenElement(7, "div");
            builder.AddAttribute(8, "class", "col");
            builder.AddContent(9, "\n            ");
            builder.OpenElement(10, "form");
            builder.AddAttribute(11, "action", "about:blank");
            builder.AddContent(12, "\n                ");
            builder.OpenElement(13, "div");
            builder.AddAttribute(14, "class", "row");
            builder.AddContent(15, "\n                    ");
            builder.OpenElement(16, "div");
            builder.AddAttribute(17, "class", "col");
            builder.AddContent(18, "\n                        ");
            builder.OpenElement(19, "div");
            builder.AddAttribute(20, "class", "form-group");
            builder.AddContent(21, "\n                            ");
            builder.AddMarkupContent(22, "<label for=\"file\">Archivo a utilizar:</label>\n                            ");
            builder.OpenElement(23, "div");
            builder.AddAttribute(24, "class", "custom-file");
            builder.AddContent(25, "\n                                ");
            builder.OpenElement(26, "input");
            builder.AddAttribute(27, "type", "file");
            builder.AddAttribute(28, "class", "custom-file-input");
            builder.AddAttribute(29, "id", "planilla");
            builder.AddAttribute(30, "onchange", Microsoft.AspNetCore.Blazor.Components.BindMethods.GetEventHandlerValue<Microsoft.AspNetCore.Blazor.UIChangeEventArgs>(FileComponentChanged));
            builder.AddAttribute(31, "required", true);
            builder.CloseElement();
            builder.AddContent(32, "\n                                ");
            builder.AddMarkupContent(33, "<label class=\"custom-file-label\" for=\"planilla\">Seleccionar archivo...</label>\n                            ");
            builder.CloseElement();
            builder.AddContent(34, "\n                        ");
            builder.CloseElement();
            builder.AddContent(35, "\n                    ");
            builder.CloseElement();
            builder.AddContent(36, "\n                    ");
            builder.OpenElement(37, "div");
            builder.AddAttribute(38, "class", "col");
            builder.AddContent(39, "\n                        ");
            builder.OpenElement(40, "div");
            builder.AddAttribute(41, "class", "form-group");
            builder.AddContent(42, "\n                            ");
            builder.AddMarkupContent(43, "<label for=\"fecha\">Fecha de la lista:</label>\n                            ");
            builder.OpenElement(44, "input");
            builder.AddAttribute(45, "type", "date");
            builder.AddAttribute(46, "name", "fecha");
            builder.AddAttribute(47, "id", "fecha");
            builder.AddAttribute(48, "class", "form-control");
            builder.AddAttribute(49, "required", true);
            builder.AddAttribute(50, "value", Microsoft.AspNetCore.Blazor.Components.BindMethods.GetValue(formCarga.Fecha, "yyyy-MM-dd"));
            builder.AddAttribute(51, "onchange", Microsoft.AspNetCore.Blazor.Components.BindMethods.SetValueHandler(__value => formCarga.Fecha = __value, formCarga.Fecha, "yyyy-MM-dd"));
            builder.CloseElement();
            builder.AddContent(52, "\n                        ");
            builder.CloseElement();
            builder.AddContent(53, "\n                    ");
            builder.CloseElement();
            builder.AddMarkupContent(54, "\n                    <div class=\"col\"></div>\n                ");
            builder.CloseElement();
            builder.AddContent(55, "\n                ");
            builder.OpenElement(56, "div");
            builder.AddAttribute(57, "class", "row");
            builder.AddContent(58, "\n                    ");
            builder.OpenElement(59, "div");
            builder.AddAttribute(60, "class", "col");
            builder.AddContent(61, "\n                        ");
            builder.OpenElement(62, "div");
            builder.AddAttribute(63, "class", "form-group");
            builder.AddContent(64, "\n                            ");
            builder.AddMarkupContent(65, "<label for=\"tipo-lista\">Seleccionar el tipo de lista:</label>\n                            ");
            builder.OpenElement(66, "select");
            builder.AddAttribute(67, "class", "custom-select custom-select-sm");
            builder.AddAttribute(68, "name", "tipo-lista");
            builder.AddAttribute(69, "id", "tipo-lista");
            builder.AddAttribute(70, "required", true);
            builder.AddAttribute(71, "value", Microsoft.AspNetCore.Blazor.Components.BindMethods.GetValue(formCarga.TipoLista));
            builder.AddAttribute(72, "onchange", Microsoft.AspNetCore.Blazor.Components.BindMethods.SetValueHandler(__value => formCarga.TipoLista = __value, formCarga.TipoLista));
            builder.AddContent(73, "\n                                ");
            builder.AddMarkupContent(74, "<option selected=\"\" disabled=\"\">-- Seleccionar tipo de Lista --</option>\n                                ");
            builder.AddMarkupContent(75, "<option value=\"yo-yo\">yo-yo</option>\n                                ");
            builder.AddMarkupContent(76, "<option value=\"powerland\">powerland</option>\n                            ");
            builder.CloseElement();
            builder.AddContent(77, "\n                        ");
            builder.CloseElement();
            builder.AddContent(78, "\n                    ");
            builder.CloseElement();
            builder.AddContent(79, "\n                    ");
            builder.OpenElement(80, "div");
            builder.AddAttribute(81, "class", "col");
            builder.AddContent(82, "\n                        ");
            builder.OpenElement(83, "div");
            builder.AddAttribute(84, "class", "form-group");
            builder.AddContent(85, "\n                            ");
            builder.AddMarkupContent(86, "<label for=\"nombre-lista\">Seleccionar el nombre de la lista:</label>\n                            ");
            builder.OpenElement(87, "select");
            builder.AddAttribute(88, "class", "custom-select custom-select-sm");
            builder.AddAttribute(89, "name", "nombre-lista");
            builder.AddAttribute(90, "id", "nombre-lista");
            builder.AddAttribute(91, "required", true);
            builder.AddAttribute(92, "value", Microsoft.AspNetCore.Blazor.Components.BindMethods.GetValue(formCarga.NombreLista));
            builder.AddAttribute(93, "onchange", Microsoft.AspNetCore.Blazor.Components.BindMethods.SetValueHandler(__value => formCarga.NombreLista = __value, formCarga.NombreLista));
            builder.AddContent(94, "\n                                ");
            builder.AddMarkupContent(95, "<option selected=\"\" disabled=\"\">-- Seleccionar Lista --</option>\n                                ");
            builder.AddMarkupContent(96, "<option value=\"POWERLAND\">POWERLAND</option>\n                                ");
            builder.AddMarkupContent(97, "<option value=\"YOYO\">YOYO</option>\n                                ");
            builder.AddMarkupContent(98, "<option value=\"YOYO-TOYS\">YOYO-TOYS</option>\n                            ");
            builder.CloseElement();
            builder.AddContent(99, "\n                        ");
            builder.CloseElement();
            builder.AddContent(100, "\n                    ");
            builder.CloseElement();
            builder.AddMarkupContent(101, "\n                    <div class=\"col\"></div>\n                ");
            builder.CloseElement();
            builder.AddContent(102, "\n            ");
            builder.CloseElement();
            builder.AddContent(103, "\n            ");
            builder.OpenElement(104, "button");
            builder.AddAttribute(105, "type", "submit");
            builder.AddAttribute(106, "class", "btn btn-primary");
            builder.AddAttribute(107, "onclick", Microsoft.AspNetCore.Blazor.Components.BindMethods.GetEventHandlerValue<Microsoft.AspNetCore.Blazor.UIMouseEventArgs>(UploadList));
            builder.AddAttribute(108, "disabled", !submitButtonEnabled);
            builder.AddContent(109, "Subir Planilla");
            builder.CloseElement();
            builder.AddContent(110, "\n");
#line 57 "C:\Users\ponch\projects\LibreriaAlvarez\LibreriaAlvarez.WebApp\Pages\CargarLista.cshtml"
             if (result)
            {

#line default
#line hidden
            builder.AddMarkupContent(111, "                <br>\n                ");
            builder.AddMarkupContent(112, "<span class=\"badge badge-pill badge-success\">La planilla fue cargada exitosamente!!</span>\n");
#line 61 "C:\Users\ponch\projects\LibreriaAlvarez\LibreriaAlvarez.WebApp\Pages\CargarLista.cshtml"
            }

#line default
#line hidden
            builder.AddContent(113, "        ");
            builder.CloseElement();
            builder.AddContent(114, "\n    ");
            builder.CloseElement();
            builder.AddContent(115, "\n");
            builder.CloseElement();
        }
        #pragma warning restore 1998
#line 66 "C:\Users\ponch\projects\LibreriaAlvarez\LibreriaAlvarez.WebApp\Pages\CargarLista.cshtml"
            
    FormCarga formCarga = new FormCarga();
    bool result = false;
    bool submitButtonEnabled = true;

    async Task UploadList()
    {
        submitButtonEnabled = false;
        formCarga.NombreHoja = "precios";

        Console.WriteLine("fecha -> {0}", formCarga.Fecha.ToString("yyyy-MM-dd"));
        Console.WriteLine("tipo lista -> {0}", formCarga.TipoLista);
        Console.WriteLine("nombre lista -> {0}", formCarga.NombreLista);
        Console.WriteLine("nombre hoja -> {0}", formCarga.NombreHoja);

        using (var form = new MultipartFormDataContent())
        {

            var fecha = new StringContent(formCarga.Fecha.ToString("yyyy-MM-dd"));
            fecha.Headers.Remove("Content-Disposition");
            fecha.Headers.Add("Content-Disposition", "form-data; name=\"fecha\"");

            var tipoLista = new StringContent(formCarga.TipoLista);
            tipoLista.Headers.Remove("Content-Disposition");
            tipoLista.Headers.Add("Content-Disposition", "form-data; name=\"tipo-lista\"");

            var nombreLista = new StringContent(formCarga.NombreLista);
            nombreLista.Headers.Remove("Content-Disposition");
            nombreLista.Headers.Add("Content-Disposition", "form-data; name=\"nombre-lista\"");

            var nombreHoja = new StringContent(formCarga.NombreHoja);
            nombreHoja.Headers.Remove("Content-Disposition");
            nombreHoja.Headers.Add("Content-Disposition", "form-data; name=\"nombre-hoja\"");

            formCarga.ListaFile.Headers.Remove("Content-Type");
            formCarga.ListaFile.Headers.Add("Content-Type", "application/vnd.ms-excel");
            formCarga.ListaFile.Headers.Remove("Content-Disposition");
            formCarga.ListaFile.Headers.Add("Content-Disposition", "form-data; name=\"file\"; filename=\"planilla.xls\"");

            form.Add(fecha);
            form.Add(tipoLista);
            form.Add(nombreLista);
            form.Add(nombreHoja);
            form.Add(formCarga.ListaFile);

            var respuesta = await LibreriaPriceservice.PostCargarPlanilla(form).ConfigureAwait(false);
            result = respuesta.IsSuccessStatusCode;
            submitButtonEnabled = true;
        }
    }

    async Task FileComponentChanged()
    {
        var data = await FileUtil.ReadFileByID("planilla");
        formCarga.ListaFile = new ByteArrayContent(Convert.FromBase64String(data));
    }

#line default
#line hidden
        [global::Microsoft.AspNetCore.Blazor.Components.InjectAttribute] private LibreriaPriceService LibreriaPriceservice { get; set; }
    }
}
#pragma warning restore 1591
